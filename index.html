<!doctype html>
<html>
<head>
	<title>Live input effects</title>
	<script src="js/effect.js"></script>
	<script src="js/waveshaper.js"></script>
	<script src="js/jungle.js"></script>
	<script src="js/effects.js"></script>
	<script src="js/pingpong.js"></script>
	<script src="js/apollo.js"></script>

	<!-- Visualizer stuff -->
	<script src="js/visualizer/events.js"></script>

	<!-- WebGL stuff -->
	<script src="js/visualizer/base.js"></script>
	<script src="js/visualizer/cameracontroller.js"></script>

	<!-- TODO(kbr): remove this dependency -->
	<script src="js/visualizer/matrix4x4.js"></script>

	<!-- Visualizer GL library -->
	<script src="js/visualizer/visualizer.js"></script>
	<script src="js/visualizer/shader.js"></script>

	<style>
	body { font: 14pt Arial, sans-serif; background: #333; color: grey; }
	select { font: 14pt Arial, sans-serif; }
	div#controls div { display:none; border: 1px solid darkgray; border-radius: 5px; padding: 10px; width: 728px;}
	div#controls div.display { display: block; }
	#controls { padding-top: 24px;}
	#effectMix { padding-top: 12px;}
	#arranger { width:750px; margin: 25px auto}
	#autoplay { width: 100%; height: 100%; }
	</style>
</head>
<body>
	<div id="autoplay">
		<button onclick="audioContext.resume(); changeInput(); document.getElementById('autoplay').style='display:none';">Start Processing</button>
	</div>
	<div>Input:
		<select id="audioinput" onchange="changeInput(this.selectedIndex);">
			<option>default (selection not supported)</option>
		</select>
	</div>

	<div id="arranger">
	<canvas id="view1" width="750" height="200"></canvas><br>
	<canvas id="view2" width="750" height="200"></canvas>
	<div>
		<input type="radio" name="radioSet" value="data" 
		onmousedown="analyserView1.setAnalysisType(ANALYSISTYPE_FREQUENCY); analyserView2.setAnalysisType(ANALYSISTYPE_FREQUENCY);">Frequency
		<input type="radio" name="radioSet" value="data" 
		onmousedown="analyserView1.setAnalysisType(ANALYSISTYPE_SONOGRAM); analyserView2.setAnalysisType(ANALYSISTYPE_SONOGRAM);">Sonogram
		<input type="radio" name="radioSet" value="data" checked="checked" 
		onmousedown="analyserView1.setAnalysisType(ANALYSISTYPE_3D_SONOGRAM); analyserView2.setAnalysisType(ANALYSISTYPE_3D_SONOGRAM);">3D Sonogram
		<input type="radio" name="radioSet" value="data" 
		onmousedown="analyserView1.setAnalysisType(ANALYSISTYPE_WAVEFORM); analyserView2.setAnalysisType(ANALYSISTYPE_WAVEFORM);">Waveform
	</div>
	<div id="effectMix">Effect: <select id="effect">
		<option>Delay </option>
		<option>Reverb </option>
		<option>Distortion </option>
		<option>Telephone </option>
		<option>Gain LFO </option>
		<option>Chorus </option>
		<option>Flange </option>
		<option>Ring mod </option>
		<option>Stereo Chorus </option>
		<option>Stereo Flange </option>
		<option>Pitch Shifter </option>
		<option>Mod Delay </option>
		<option>Ping-pong delay</option>
		<option>LFO Filter</option>
		<option>Envelope Follower (testing only)</option>
		<option>Autowah</option>
		<option>Noise Gate</option>
		<option>Wah Bass</option>
		<option>Distorted Wah Chorus</option>
		<option>Vibrato</option>
		<option>BitCrusher</option>
		<option>Apollo Quindar Tones</option>
		<option>Invert</option>
</select>
&nbsp;&nbsp;Effect Mix: <input type="range" min="0.0" max="1.0" step="0.01" value="1.0" style="height: 20px; width: 200px;" 
onInput="crossfade(event.target.value);">
&nbsp;&nbsp;Mono input: <input type="checkbox" checked onchange="toggleMono()">
</div>

<div id="controls">
	<!-- Aqui você pode adicionar controles específicos do efeito Invert, se quiser -->
	<div id="invertControls">Invert effect: <br>
		<button onclick="toggleInvert()">Toggle Invert</button>
	</div>
</div>

<script>
// Cria um nó de ganho para inverter a fase
let invertNode = audioContext.createGain();
invertNode.gain.value = 1.0; // padrão

function toggleInvert() {
	if (!invertNode) return;
	invertNode.gain.value = invertNode.gain.value === 1 ? -1 : 1;
}
</script>

<a href="https://github.com/cwilso/Audio-Input-Effects" style="position: absolute; z-index:2; top: 0; right: 0; border: 0;"><img src="img/forkme.png" alt="Fork me on GitHub"></a>
</body>
</html>
